<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Japan Healthcare Research Hub | Seed Planning</title>
<meta name="description" content="Comprehensive hub for conducting healthcare market research in Japan. FAQ, guides, and expert resources in one place." />
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2248%22 fill=%22%235baaae%22/><text x=%2250%22 y=%2263%22 font-size=%2255%22 text-anchor=%22middle%22 fill=%22white%22 font-family=%22Arial%22>SP</text></svg>">
<style>
  :root{
    /* Unified Medical Green Theme */
    --bg: #ffffff;
    --ink: #21343b;
    --muted: #5e7a85;
    --line: #e6eff1;
    --accent: #2f6f7e;
    --accent-2: #5baaae;
    --chip: #edf7f7;
    --mark: #fff3b0;
    --radius: 14px;
    --radius-sm: 10px;
    --shadow: 0 6px 24px rgba(24,60,70,.08);
    --shadow-light: 0 2px 8px rgba(24,60,70,.06);
  }
  
  html, body {
    margin: 0;
    background: var(--bg);
    color: var(--ink);
    font-family: "Inter", "Noto Sans", "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, Arial;
    line-height: 1.7;
  }
  
  /* Header */
  header {
    padding: 48px 24px 32px;
    max-width: 1120px;
    margin: 0 auto;
    text-align: center;
  }
  
  .sup {
    color: var(--accent-2);
    letter-spacing: 0.08em;
    font-size: 12px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  h1 {
    margin: 0.2rem 0 0;
    font-weight: 800;
    font-size: clamp(32px, 4vw, 48px);
    color: var(--ink);
    line-height: 1.2;
  }
  
  .lead {
    color: var(--muted);
    margin: 10px auto 24px;
    max-width: 850px;
    line-height: 1.7;
    font-size: 16px;
  }
  
  /* Navigation Tabs */
  .nav-tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin: 32px 0;
    background: var(--chip);
    border-radius: var(--radius);
    padding: 4px;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
  }
  
  .nav-tab {
    flex: 1;
    padding: 12px 20px;
    background: transparent;
    border: none;
    border-radius: var(--radius-sm);
    font-weight: 600;
    font-size: 14px;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .nav-tab.active {
    background: var(--accent);
    color: white;
    box-shadow: var(--shadow-light);
  }
  
  /* Unified Search */
  .unified-search {
    max-width: 600px;
    margin: 0 auto 40px;
    position: relative;
  }
  
  .search-container {
    display: flex;
    align-items: center;
    gap: 12px;
    background: var(--bg);
    border: 1px solid var(--line);
    border-radius: var(--radius);
    padding: 14px 18px;
    box-shadow: var(--shadow-light);
  }
  
  .search-input {
    flex: 1;
    border: none;
    outline: none;
    font-size: 16px;
    background: transparent;
    color: var(--ink);
  }
  
  .search-input::placeholder {
    color: var(--muted);
  }
  
  /* Content Areas */
  .content-area {
    display: none;
    max-width: 1120px;
    margin: 0 auto;
    padding: 0 24px 80px;
  }
  
  .content-area.active {
    display: block;
  }
  
  /* Guide Section (from resources.html) */
  .guide-section {
    background: var(--chip);
    border: 1px solid var(--line);
    border-radius: var(--radius);
    padding: 24px;
    margin-bottom: 40px;
    box-shadow: var(--shadow-light);
  }
  
  .guide-title {
    margin: 0 0 8px;
    font-size: 24px;
    font-weight: 700;
    color: var(--accent-2);
  }
  
  .guide-subtitle {
    margin: 0 0 24px;
    color: var(--muted);
    font-size: 14px;
  }
  
  /* Cards Grid */
  .cards-grid {
    display: grid;
    gap: 20px;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }
  
  .content-card {
    background: var(--bg);
    border: 1px solid var(--line);
    border-radius: var(--radius-sm);
    padding: 20px;
    box-shadow: var(--shadow-light);
    transition: all 0.2s ease;
  }
  
  .content-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow);
    border-color: var(--accent-2);
  }
  
  .card-type {
    font-size: 11px;
    color: var(--accent);
    background: var(--chip);
    padding: 4px 8px;
    border-radius: 12px;
    display: inline-block;
    margin-bottom: 8px;
    font-weight: 600;
    text-transform: uppercase;
  }
  
  .card-title {
    font-size: 18px;
    font-weight: 700;
    color: var(--ink);
    margin: 0 0 8px;
    line-height: 1.3;
  }
  
  .card-summary {
    color: var(--muted);
    font-size: 14px;
    line-height: 1.6;
    margin: 0 0 16px;
  }
  
  .card-actions {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }
  
  .btn {
    background: var(--accent);
    color: white;
    border: 1px solid var(--accent);
    border-radius: var(--radius-sm);
    padding: 8px 12px;
    font-weight: 600;
    text-decoration: none;
    font-size: 13px;
    transition: all 0.2s ease;
  }
  
  .btn:hover {
    background: var(--accent-2);
    border-color: var(--accent-2);
  }
  
  .btn.secondary {
    background: var(--chip);
    color: var(--ink);
    border-color: var(--line);
  }
  
  .btn.secondary:hover {
    background: var(--line);
  }
  
  /* Cross-reference highlights */
  .cross-ref {
    background: var(--mark);
    padding: 2px 4px;
    border-radius: 4px;
    font-weight: 500;
  }
  
  /* Search visibility control */
  .unified-search.hidden {
    display: none;
  }
  
  /* Search suggestions dropdown */
  .search-suggestions {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--bg);
    border: 1px solid var(--line);
    border-top: none;
    border-radius: 0 0 var(--radius) var(--radius);
    box-shadow: var(--shadow);
    max-height: 300px;
    overflow-y: auto;
    z-index: 100;
    display: none;
  }
  
  .search-suggestions.show {
    display: block;
  }
  
  .suggestion-item {
    padding: 12px 18px;
    border-bottom: 1px solid var(--line);
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  
  .suggestion-item:last-child {
    border-bottom: none;
  }
  
  .suggestion-item:hover,
  .suggestion-item.selected {
    background: var(--chip);
  }
  
  .suggestion-title {
    font-weight: 600;
    color: var(--ink);
    font-size: 14px;
    margin-bottom: 4px;
  }
  
  .suggestion-type {
    font-size: 11px;
    color: var(--accent);
    text-transform: uppercase;
    font-weight: 600;
  }
  
  .suggestion-preview {
    font-size: 12px;
    color: var(--muted);
    line-height: 1.4;
  }
  
  /* Text highlighting */
  .highlight {
    background: var(--mark);
    padding: 1px 2px;
    border-radius: 3px;
    font-weight: 500;
  }
  
  /* Remove PDF highlighting */
  .content-card[data-type="pdf"] .highlight {
    background: transparent;
    font-weight: normal;
  }
  
  /* Responsive */
  @media (max-width: 768px) {
    .nav-tabs {
      flex-direction: column;
      max-width: 300px;
    }
    
    .cards-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
</head>
<body>
  <header>
    <div class="sup">Seed Planning | Research Hub</div>
    <h1>Japan Healthcare Research Hub</h1>
    <p class="lead">Your comprehensive resource for conducting healthcare market research in Japan. FAQ answers, expert guides, and actionable insights in one integrated platform.</p>
    
    <!-- Unified Search -->
    <div class="unified-search">
      <div class="search-container">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M10 2a8 8 0 0 1 6.32 12.906l4.387 4.387l-1.414 1.414l-4.387-4.387A8 8 0 1 1 10 2m0 2a6 6 0 1 0 0 12a6 6 0 0 0 0-12"/>
        </svg>
        <input type="search" class="search-input" placeholder="Search FAQ and resources (e.g., APPI, recruitment, oncology)..." id="unified-search">
      </div>
      <div class="search-suggestions" id="search-suggestions"></div>
    </div>
  </header>

  <!-- Navigation Tabs -->
  <div class="nav-tabs">
    <button class="nav-tab active" data-tab="guide">üéØ Guided Start</button>
    <button class="nav-tab" data-tab="resources">üìö Resources</button>
    <button class="nav-tab" data-tab="faq">‚ùì FAQ</button>
    <button class="nav-tab" data-tab="all">üîç Search All</button>
  </div>

  <!-- Guide Content -->
  <div class="content-area active" id="guide-content">
    <div class="guide-section">
      <h2 class="guide-title">What would you like to know?</h2>
      <p class="guide-subtitle">Choose your focus area, and we'll guide you to the most relevant FAQ and resources</p>
      
      <div class="cards-grid">
        <div class="content-card" data-focus="patient">
          <div class="card-type">Patient Research</div>
          <h3 class="card-title">Patient Studies & Recruitment</h3>
          <p class="card-summary">Master Japanese patient research with insights on family-involved decision-making, high health literacy expectations, privacy sensitivities, and effective recruitment through trusted channels. Learn optimal survey design, interview techniques, and how to navigate the unique doctor-patient relationship dynamics.</p>
          <div class="card-actions">
            <a href="#" class="btn">Start Here</a>
          </div>
        </div>
        
        <div class="content-card" data-focus="hcp">
          <div class="card-type">HCP Research</div>
          <h3 class="card-title">Healthcare Professional Studies</h3>
          <p class="card-summary">Navigate Japan's complex medical hierarchy effectively. Understand university vs. community physician dynamics, respect seniority protocols, master appropriate honoraria levels, and learn timing strategies that respect Japanese physicians' schedules. Includes KOL identification and advisory board management.</p>
          <div class="card-actions">
            <a href="#" class="btn">Start Here</a>
          </div>
        </div>
        
        <div class="content-card" data-focus="system">
          <div class="card-type">Healthcare System</div>
          <h3 class="card-title">Japan Healthcare System</h3>
          <p class="card-summary">Decode Japan's government-controlled pricing system, understand universal coverage impact on patient behavior, and master stakeholder mapping across MHLW, PMDA, and medical societies. Essential for understanding how reimbursement shapes treatment adoption.</p>
          <div class="card-actions">
            <a href="#" class="btn">Start Here</a>
          </div>
        </div>
        
        <div class="content-card" data-focus="compliance">
          <div class="card-type">Compliance & Legal</div>
          <h3 class="card-title">Regulatory Compliance</h3>
          <p class="card-summary">Navigate Japan's strict privacy landscape with confidence. Master APPI (Japan's GDPR), understand consent requirements for healthcare data, manage cross-border data transfers compliantly, and ensure adverse event reporting compliance.</p>
          <div class="card-actions">
            <a href="#" class="btn">Start Here</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Resources Content -->
  <div class="content-area" id="resources-content">
    <h2 style="color: var(--accent-2); margin-bottom: 20px;">üìö Expert Resources</h2>
    <div id="resources-grid" class="cards-grid"></div>
  </div>

  <!-- FAQ Content -->
  <div class="content-area" id="faq-content">
    <h2 style="color: var(--accent-2); margin-bottom: 20px;">‚ùì Frequently Asked Questions</h2>
    <div id="faq-grid" class="cards-grid"></div>
  </div>

  <!-- All Content -->
  <div class="content-area" id="all-content">
    <h2 style="color: var(--accent-2); margin-bottom: 20px;">üîç All Resources & FAQ</h2>
    <div id="all-grid" class="cards-grid"></div>
  </div>

<!-- Load FAQ data -->
<script src="data/faqs.js"></script>

<script>
// ---- PDF Data (from resources.html) ----
const docs = [
  {
    title: "Guide to Japan Medical Research ‚Äî FAQ (Full Version)",
    filename: "Guide_to_Japan_Medical_Research_FAQ.pdf",
    category: "FAQ & Playbook",
    tags: ["FAQ","localization","recruitment","APPI","honoraria"],
    summary: "68-question FAQ spanning insurance basics, access, HCP roles, oncology pathways, recruitment & incentives, privacy/APPI, and moderation culture‚Äîbuilt as a one‚Äëstop primer for overseas teams planning research in Japan. Includes do's/don'ts and scheduling caveats.",
    site: "https://yoshi-seed.github.io/global/index.html",
    id: "faq-guide",
    type: "pdf"
  },
  {
    title: "Insights into Japan's Universal Health Insurance System",
    filename: "Japan_insurance_system_summary_Drug_Pricing_Process_by_Seed_Planning.pdf",
    category: "Insurance & Access",
    tags: ["universal coverage","free access","fee schedule"],
    summary: "How Japan's universal coverage, low co-pays, and nationwide fee schedule shape provider incentives and patient behavior. What this means for research access, HCP availability, and why non-reimbursed activities can be hard to drive without clear value or support.",
    id: "insurance-guide",
    type: "pdf"
  },
  {
    title: "Japan Insurance System ‚Äî Pricing & Reimbursement Basics",
    filename: "Japan_insurance_system_summary_Drug_Pricing_Process_by_Seed_Planning.pdf",
    category: "Pricing & Reimbursement",
    tags: ["points system","biennial revision","drug pricing"],
    summary: "A practical walkthrough of codes, points, and periodic price revisions. Explains why site-level price flexibility is limited, how to read codes correctly, and how to budget realistically for Japan-based activities.",
    id: "pricing-guide",
    type: "pdf"
  },
  {
    title: "Navigating Privacy & Platforms in Japanese Patient Research",
    filename: "Navigating_Privacy_and_Platforms_in_Japanese_Patient_Research_by_Seed_Planning.pdf",
    category: "Privacy & Data",
    tags: ["APPI","consent","cross-border transfer","UX"],
    summary: "APPI requirements made usable: explicit consent, purpose limitation, and managing cross-border transfers. Platform choices that reduce friction for Japanese users, plus operational guardrails (pre-briefs, guides, test connections) to prevent drop-off and data loss.",
    id: "privacy-guide",
    type: "pdf"
  },
  {
    title: "Patient‚ÄëCentered Market Research in Japan ‚Äî A Practical Guide",
    filename: "Patient-Centered_Market_Research_in_Japan_by_Seed_Planning.pdf",
    category: "Patient Research",
    tags: ["recruitment","culture","informed consent","rare disease"],
    summary: "Culturally aware recruitment and moderation for Japan. Rapport, silence, and respect matter. Tips for rare and stigmatized conditions, partnering with PAGs, and designing consent and incentives that feel appropriate and transparent.",
    id: "patient-guide",
    type: "pdf"
  },
  {
    title: "Understanding Oncology Dynamics in Japan",
    filename: "Understanding_Oncology_Dynamics_in_Japan_by_Seed_Planning.pdf",
    category: "Oncology Landscape",
    tags: ["organ‚Äëbased care","cancer centers","trials","KOL networks"],
    summary: "Why organ‚Äëbased departments (incl. surgery) often lead systemic therapy, and how designated cancer centers anchor care and research. Implications for recruiting oncologists, mapping referral flows, and tapping into KOL ecosystems.",
    id: "oncology-guide",
    type: "pdf"
  },
  {
    title: "Japan Annual Health Check‚ÄëUps ‚Äî What They Mean for Research (v2)",
    filename: "Japan_annual_health_check_up_insights_v2_by_Seed_Planning.pdf",
    category: "Screening & Checkups",
    tags: ["annual checkups","corporate programs","sampling"],
    summary: "High uptake of annual checkups and comprehensive screens. Useful for early‚Äëdetection and wellness topics, but be mindful of self‚Äëreport bias and limited continuity with primary care. Practical guidance for screener design and sample planning.",
    id: "checkup-guide",
    type: "pdf"
  },
  {
    title: "Japan Medical Research ‚Äî Fieldwork Guide & Tips",
    filename: "Japan_medical_research_guide_and_tips_by_Seed_Planning.pdf",
    category: "Fieldwork & Moderation",
    tags: ["localization","moderation","screeners","translation"],
    summary: "Everything we wish overseas teams knew before fieldwork in Japan: local moderators, Japan‚Äëspecific screeners, disclosure around recording/privacy, and the level of detail needed in Japanese study materials to build trust and reduce drop‚Äëouts.",
    id: "fieldwork-guide",
    type: "pdf"
  }
];

// ---- Get FAQ Data ----
function getAllFAQs(){
  try { if (Array.isArray(window.FAQS) && window.FAQS.length) return window.FAQS; } catch(e){}
  return [];
}

const FAQS = getAllFAQs().map(faq => ({...faq, type: 'faq'}));
const ALL_CONTENT = [...docs, ...FAQS];

// ---- Cross-reference mapping ----
const CROSS_REFERENCES = {
  "Q1": ["insurance-guide", "faq-guide"],
  "Q2": ["insurance-guide", "pricing-guide"],
  "Q3": ["insurance-guide"],
  "Q12": ["privacy-guide"],
  "Q13": ["privacy-guide"],
  "Q14": ["privacy-guide"],
  "Q25": ["patient-guide"],
  "Q26": ["patient-guide"],
  "Q27": ["patient-guide"],
  "Q45": ["oncology-guide"],
  "Q46": ["oncology-guide"]
};

// ---- Utility Functions ----
const escapeHTML = (s) => String(s||"").replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[m]));
const fileUrl = (name) => "https://yoshi-seed.github.io/pdf/" + encodeURIComponent(name);

// ---- Search Functionality ----
function searchContent(query, currentTab = null) {
  if (!query.trim()) return ALL_CONTENT;
  
  const terms = query.toLowerCase().split(/\s+/).filter(Boolean);
  
  const results = ALL_CONTENT.filter(item => {
    const searchText = [
      item.title || '',
      item.summary || '',
      item.question || '',
      item.answer || '',
      item.category || '',
      (item.tags || []).join(' ')
    ].join(' ').toLowerCase();
    
    return terms.some(term => searchText.includes(term));
  });
  
  // Sort based on current tab
  return results.sort((a, b) => {
    // If we're in FAQ tab, prioritize FAQ items heavily
    if (currentTab === 'faq') {
      if (a.type !== b.type) {
        return a.type === 'faq' ? -1 : 1;
      }
    } else {
      // For other tabs, still prefer FAQ but less aggressively
      if (a.type !== b.type) {
        return a.type === 'faq' ? -1 : 1;
      }
    }
    return 0;
  });
}

// ---- Text Highlighting ----
function highlightText(text, terms) {
  if (!text || !terms || terms.length === 0) return escapeHTML(text);
  
  let highlightedText = escapeHTML(text);
  
  terms.forEach(term => {
    if (term.length > 1) { // Only highlight terms longer than 1 character
      const regex = new RegExp(`(${term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
      highlightedText = highlightedText.replace(regex, '<span class="highlight">$1</span>');
    }
  });
  
  return highlightedText;
}

// ---- Search Suggestions ----
function showSearchSuggestions(query) {
  const suggestionsContainer = document.getElementById('search-suggestions');
  if (!suggestionsContainer) return;
  
  if (!query.trim()) {
    suggestionsContainer.classList.remove('show');
    return;
  }
  
  const results = searchContent(query).slice(0, 8); // Show top 8 results
  
  if (results.length === 0) {
    suggestionsContainer.classList.remove('show');
    return;
  }
  
  const terms = query.toLowerCase().split(/\s+/).filter(Boolean);
  
  suggestionsContainer.innerHTML = results.map((item, index) => {
    const title = item.question || item.title || '';
    const preview = (item.answer || item.summary || '').slice(0, 80) + (item.answer?.length > 80 ? '...' : '');
    
    return `
      <div class="suggestion-item" data-index="${index}" data-id="${item.id}" data-type="${item.type}">
        <div class="suggestion-type">${item.type.toUpperCase()}</div>
        <div class="suggestion-title">${highlightText(title, terms)}</div>
        <div class="suggestion-preview">${highlightText(preview, terms)}</div>
      </div>
    `;
  }).join('');
  
  suggestionsContainer.classList.add('show');
  
  // Add click handlers to suggestions
  suggestionsContainer.querySelectorAll('.suggestion-item').forEach(item => {
    item.addEventListener('click', () => {
      const itemId = item.dataset.id;
      const itemType = item.dataset.type;
      
      // Navigate to appropriate tab and scroll to item
      navigateToItem(itemId, itemType);
      
      // Hide suggestions
      suggestionsContainer.classList.remove('show');
    });
  });
}

// ---- Navigation to specific items ----
function navigateToItem(itemId, itemType) {
  // Switch to appropriate tab
  const targetTab = itemType === 'faq' ? 'faq' : itemType === 'pdf' ? 'resources' : 'all';
  
  // Update active tab
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.querySelector(`[data-tab="${targetTab}"]`).classList.add('active');
  
  // Control search box visibility
  toggleSearchBox(true);
  
  // Show corresponding content
  document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
  const targetContent = document.getElementById(targetTab + '-content');
  if (targetContent) {
    targetContent.classList.add('active');
    showTab(targetTab);
  }
  
  // Scroll to the specific item after a brief delay
  setTimeout(() => {
    const itemElement = document.querySelector(`[data-item-id="${itemId}"]`);
    if (itemElement) {
      itemElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
      // Briefly highlight the item
      itemElement.style.borderColor = 'var(--accent)';
      itemElement.style.borderWidth = '2px';
      setTimeout(() => {
        itemElement.style.borderColor = '';
        itemElement.style.borderWidth = '';
      }, 2000);
    }
  }, 100);
}

// ---- Render Functions ----
function renderCard(item, searchTerms = []) {
  const isOnline = item.site && item.site.includes('yoshi-seed.github.io');
  
  if (item.type === 'faq') {
    const crossRefs = CROSS_REFERENCES[item.id] || [];
    const crossRefLinks = crossRefs.map(ref => {
      const doc = docs.find(d => d.id === ref);
      if (!doc) return '';
      // Prefer PDF link, fallback to online site
      return `<a href="${fileUrl(doc.filename)}" class="cross-ref" target="_blank">${doc.title}</a>`;
    }).filter(Boolean).join(', ');
    
    const answerPreview = item.answer.length > 200 ? item.answer.slice(0, 200) + '...' : item.answer;
    
    return `
      <div class="content-card" data-item-id="${item.id}" data-type="${item.type}">
        <div class="card-type">FAQ</div>
        <h3 class="card-title">${highlightText(item.question, searchTerms)}</h3>
        <p class="card-summary">${highlightText(answerPreview, searchTerms)}</p>
        ${crossRefLinks ? `<p style="font-size: 12px; color: var(--muted);"><strong>Related PDFs:</strong> ${crossRefLinks}</p>` : ''}
        <div class="card-actions">
          ${isOnline ? `<a href="${item.site}" class="btn" target="_blank">View Online</a>` : ''}
          <a href="article.html?id=${encodeURIComponent(item.id)}" class="btn secondary">Full Answer</a>
        </div>
      </div>
    `;
  } else {
    return `
      <div class="content-card" data-item-id="${item.id}" data-type="${item.type}">
        <div class="card-type">PDF</div>
        <h3 class="card-title">${escapeHTML(item.title)}</h3>
        <p class="card-summary">${escapeHTML(item.summary)}</p>
        <div class="card-actions">
          <a href="${fileUrl(item.filename)}" class="btn" target="_blank">üìÑ Download PDF</a>
          ${item.site ? `<a href="${item.site}" class="btn secondary" target="_blank">View Online</a>` : ''}
        </div>
      </div>
    `;
  }
}

function renderContent(items, containerId, searchTerms = []) {
  const container = document.getElementById(containerId);
  if (!container) {
    console.error('Container not found:', containerId);
    return;
  }
  
  if (items.length === 0) {
    container.innerHTML = '<div style="text-align: center; color: var(--muted); padding: 40px;">No matching content found.</div>';
    return;
  }
  
  container.innerHTML = items.map(item => renderCard(item, searchTerms)).join('');
}

// ---- Tab Management ----
function showTab(tabName) {
  let content;
  let containerId;
  
  switch(tabName) {
    case 'resources':
      content = docs;
      containerId = 'resources-grid';
      break;
    case 'faq':
      content = FAQS;
      containerId = 'faq-grid';
      break;
    case 'all':
      content = ALL_CONTENT;
      containerId = 'all-grid';
      break;
    default:
      return;
  }
  
  console.log(`Showing ${tabName} tab with ${content.length} items`);
  renderContent(content, containerId);
}

// ---- Search Box Visibility Control ----
function toggleSearchBox(show) {
  const searchBox = document.querySelector('.unified-search');
  if (!searchBox) return;
  
  if (show) {
    searchBox.classList.remove('hidden');
  } else {
    searchBox.classList.add('hidden');
  }
}

// ---- Event Listeners ----
document.querySelectorAll('.nav-tab').forEach(tab => {
  tab.addEventListener('click', () => {
    const tabName = tab.dataset.tab;
    
    // Update active tab
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    
    // Control search box visibility
    if (tabName === 'guide') {
      toggleSearchBox(false); // Hide search box for Guided Start
    } else {
      toggleSearchBox(true);  // Show search box for other tabs
    }
    
    // Show corresponding content
    document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
    const targetContent = document.getElementById(tabName + '-content');
    if (targetContent) {
      targetContent.classList.add('active');
      if (tabName !== 'guide') {
        showTab(tabName);
      }
    }
  });
});

// Unified search with enhanced functionality
document.addEventListener('DOMContentLoaded', () => {
  const searchInput = document.getElementById('unified-search');
  const suggestionsContainer = document.getElementById('search-suggestions');
  let selectedSuggestionIndex = -1;
  
  if (!searchInput) {
    console.error('Search input not found!');
    return;
  }
  
  // Input handler for search
  searchInput.addEventListener('input', (e) => {
    const query = e.target.value;
    const activeTab = document.querySelector('.nav-tab.active')?.dataset.tab;
    
    console.log('Searching for:', query, 'in tab:', activeTab);
    
    // Show suggestions
    showSearchSuggestions(query);
    
    const results = searchContent(query, activeTab);
    const searchTerms = query.toLowerCase().split(/\s+/).filter(Boolean);
    
    console.log('Search results:', results.length, 'items');
    
    // Update all tab contents with search results
    const pdfResults = results.filter(item => item.type === 'pdf');
    const faqResults = results.filter(item => item.type === 'faq');
    
    console.log('PDF results:', pdfResults.length);
    console.log('FAQ results:', faqResults.length);
    
    renderContent(pdfResults, 'resources-grid', searchTerms);
    renderContent(faqResults, 'faq-grid', searchTerms);
    renderContent(results, 'all-grid', searchTerms);
    
    selectedSuggestionIndex = -1; // Reset selection
  });
  
  // Keyboard navigation for suggestions
  searchInput.addEventListener('keydown', (e) => {
    const suggestions = suggestionsContainer.querySelectorAll('.suggestion-item');
    
    if (e.key === 'ArrowDown') {
      e.preventDefault();
      selectedSuggestionIndex = Math.min(selectedSuggestionIndex + 1, suggestions.length - 1);
      updateSuggestionSelection(suggestions);
    } else if (e.key === 'ArrowUp') {
      e.preventDefault();
      selectedSuggestionIndex = Math.max(selectedSuggestionIndex - 1, -1);
      updateSuggestionSelection(suggestions);
    } else if (e.key === 'Enter') {
      e.preventDefault();
      if (selectedSuggestionIndex >= 0 && suggestions[selectedSuggestionIndex]) {
        suggestions[selectedSuggestionIndex].click();
      }
    } else if (e.key === 'Escape') {
      suggestionsContainer.classList.remove('show');
      selectedSuggestionIndex = -1;
    }
  });
  
  // Hide suggestions when clicking outside
  document.addEventListener('click', (e) => {
    if (!searchInput.contains(e.target) && !suggestionsContainer.contains(e.target)) {
      suggestionsContainer.classList.remove('show');
    }
  });
  
  function updateSuggestionSelection(suggestions) {
    suggestions.forEach((item, index) => {
      if (index === selectedSuggestionIndex) {
        item.classList.add('selected');
      } else {
        item.classList.remove('selected');
      }
    });
  }
});

// Focus area navigation
document.querySelectorAll('[data-focus]').forEach(card => {
  card.addEventListener('click', () => {
    const focus = card.dataset.focus;
    let searchTerms = '';
    
    switch(focus) {
      case 'patient':
        searchTerms = 'patient recruitment consent privacy';
        break;
      case 'hcp':
        searchTerms = 'HCP oncology fieldwork moderation';
        break;
      case 'system':
        searchTerms = 'insurance pricing healthcare system';
        break;
      case 'compliance':
        searchTerms = 'APPI privacy compliance legal';
        break;
    }
    
    document.getElementById('unified-search').value = searchTerms;
    const results = searchContent(searchTerms);
    
    // Switch to All tab and show results
    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
    document.querySelector('[data-tab="all"]').classList.add('active');
    document.querySelectorAll('.content-area').forEach(area => area.classList.remove('active'));
    document.getElementById('all-content').classList.add('active');
    
    renderContent(results, 'all-content');
  });
});

// ---- Initialize ----
document.addEventListener('DOMContentLoaded', () => {
  // Initialize all tabs with content
  showTab('resources');
  showTab('faq'); 
  showTab('all');
  
  // Hide search box initially (Guided Start is active by default)
  toggleSearchBox(false);
  
  console.log('Hub initialized with', ALL_CONTENT.length, 'total items');
  console.log('FAQ items:', FAQS.length);
  console.log('PDF items:', docs.length);
});
</script>

<!-- Footer with standalone page links -->
<footer style="margin-top: 80px; padding: 40px 24px; background: var(--chip); border-top: 1px solid var(--line);">
  <div style="max-width: 1120px; margin: 0 auto; text-align: center;">
    <p style="color: var(--muted); font-size: 14px; margin-bottom: 16px;">
      For dedicated search and filtering features:
    </p>
    <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
      <a href="faq-standalone.html" style="color: var(--accent); font-weight: 500; font-size: 14px;">
        ‚ùì FAQ Standalone Page (Advanced Search)
      </a>
      <a href="resources-standalone.html" style="color: var(--accent); font-weight: 500; font-size: 14px;">
        üìö Resources Standalone Page (Category Filters)
      </a>
    </div>
    <p style="color: var(--muted); font-size: 12px; margin-top: 24px;">
      ¬© 2025 Seed Planning Co., Ltd. All rights reserved.
    </p>
  </div>
</footer>
</body>
</html>